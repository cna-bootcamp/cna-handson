# 마이그룹 서비스 프론트엔드 개발  

마이그룹 서비스의 프론트엔드를 개발합니다.   
프론트엔드 개발 전에 [마이그룹 서비스 개발하기](https://github.com/cna-bootcamp/cna-handson/blob/main/backend/04.develop_mygrp.md)를 먼저 하십시오.  

> **마이그룹 프론트엔드 개발 화면**   
> **메인화면**: 구독 비용과 구독그룹 목록 추가    
> ![alt text](image-26.png)    
> **마이그룹 서브메인 화면**   
> ![alt text](image-27.png)   
> **구독그룹 생성**   
> ![alt text](image-28.png)   
> **구독그룹 참여**  
> ![alt text](image-29.png)  

- [마이그룹 서비스 프론트엔드 개발](#마이그룹-서비스-프론트엔드-개발)
  - [브랜치 만들기](#브랜치-만들기)
  - [메인화면 개발](#메인화면-개발)
  - [마이그룹 서브 화면 개발](#마이그룹-서브-화면-개발)
  - [라우팅 설정](#라우팅-설정)
  - [애플리케이션 실행](#애플리케이션-실행)
  - [Git 푸시](#git-푸시)

---

## 브랜치 만들기  
vscode에서 터미널을 열고 아래 명령으로 새로운 브랜치를 만듭니다.   
```
git checkout -B mygrp 
```

## 메인화면 개발  

클론 프로젝트의 pages/Main/**Main.jsx 내용을 복사하여 바꿉니다**.  
TotalFeeSave와 SubGroupList 컴포넌트가 추가 되었습니다.    

> **총 구독비용과 최대 절감액 표시**   
> TotalFeeSave 컴포넌트는 총 구독비용에 따른 이미지, 총 구독비용, 최대 절감액을 표시합니다.  
> TotalFee 객체를 전달받아 표시를 하는데, TotalFee 객체를 만들어서 전달하는   
> 컴포넌트는 SubscriptionList입니다.  
> - SubscriptionList 로딩 시 API 호출하여 가입구독서비스 정보를 얻고 TotalFee객체 생성  
> - TotalFee객체가 생성되면 onTatalFee이벤트가 발생하고 Main의 handleTotalFee가 실행됨   
> - handleTotalFee는 totalFee변수에 값을 셋팅하게 됨   
> - TotalFeeSave 컴포넌트에 변경된 totalFee 객체 값이 전달되고 정보가 표시됨    

```
{중략}
import TotalFeeSave from "pages/Main/components/TotalFeeSave";
{중략}
import SubGroupList from "pages/Main/components/SubGroupList";
{중략}
function Home({ user }) {
  {중략}
  const handleTotalFee = (data) => {
    setTotalFee(data);
  };

  {중략}
  
  return (
    <>
      {중략}

      <TotalFeeSave totalFee={totalFee} navigate={navigate} />

      <SubGroupList
        user={user}
        navigate={navigate}
      />

      <SubscriptionList
        user={user}
        navigate={navigate}
        onTotalFee={handleTotalFee}
      />
      {중략}
    </>
  );
}
```  

클론 프로젝트의 pages/Main/components/SubscriptionList.jsx 파일의 내용을 복사하여  
**SubscriptionList.jsx을 변경**합니다.  
구독비용과 최대절감액을 계산하여 TotalFee객체를 생성하는 수행이 추가되었습니다.  
```
  useEffect(() => {
    const fetchData = async () => {
      try {
        const [subscriptionList] = await Promise.all([
          getSubscriptionList(user.id),
        ]);
        setSubscriptionList(subscriptionList);

        // totalFee 객체 생성
        const newTotalFee = subscriptionList.reduce(
          (acc, item) => {
            acc.payedFee += item.payedFee;
            acc.discountedFee += item.discountedFee;
            return acc;
          },
          { payedFee: 0, discountedFee: 0, feeLevel: 0 }
        );

        // feeLevel 계산
        let feeLevel = 0;
        if (newTotalFee.payedFee >= 200000) {
          feeLevel = 3;
        } else if (newTotalFee.payedFee >= 100000) {
          feeLevel = 2;
        } else if (newTotalFee.payedFee >= 50000) {
          feeLevel = 1;
        }
        newTotalFee.feeLevel = feeLevel;

        setTotalFee(newTotalFee);
      } catch (err) {
        console.log(err);
      }
    };

    fetchData();
  }, [user]);

  useEffect(() => {
    onTotalFee(totalFee);
  }, [totalFee, onTotalFee]);
```

클론 프로젝트의 pages/Main/**SubGroupList와 TotalFeeSave** 파일을 복사하여  
개발 프로젝트의 동일 위치에 붙여 넣습니다. 

---

## 마이그룹 서브 화면 개발 
클론 프로젝트에서 pages/SubGroup 디렉토리를 복사하여 개발 프로젝트에 붙여 넣습니다.  


## 라우팅 설정   
클론 프로젝트의 routes/subscription.routes.js의 내용을 복사하여   
개발 프로젝트의 동일한 파일 내용을 덮어 씁니다.     
마이그룹 서브 메인 이동을 위한 라우팅 설정이 추가 되었습니다.     

```
{중략}
import mygrpscription from "pages/Subscription/mygrpscription";

{중략}

const SubscriptionRoutes = ({ user }) => {
  return (
    <Routes>
      <Route path="/mygrpscription" element={<mygrpscription user={user} />} />
      {중략}
    </Routes>
  );
};

export default SubscriptionRoutes;
```

## 애플리케이션 실행  

  터미널에서 애플리케이션을 시작하십시오.  
  ```
  npm start
  ```

  구독서비스 추가와 구독 취소도 테스트 합니다.   


  테스트가 끝나면 **터미널에서 CTRL-c로 중단**합니다.   
  

## Git 푸시 
원격 Git repository에 소스를 푸시합니다.  
```
git add . && git commit -m "mygrp" && git push -u origin mygrp 
```

Tag를 추가하고 푸시합니다.  
```
git tag -a v3.0.0 -m "마이그룹"
git push origin v3.0.0
```

---

마이그룹 프론트엔드를 추가 개발 했습니다.  
수고하셨습니다.  

